<script>
  const target = 'http://localhost:5173'
  const newWindow = window.open(target, '_blank','width=800,height=600')
  const checkLoad = setInterval(function() {
    if (newWindow.closed) {
      clearInterval(checkLoad);
      return;
    }

    try {
      newWindow.postMessage({
        oklch_picker: true,
        type: 'handshake'
      }, '*');

      clearInterval(checkLoad);
    } catch (e) {}
  }, 100);

  window.addEventListener('message', function(event) {
    if (!event.data || !event.data.oklch_picker) {
      return
    }
    switch (event.data.type) {
      case 'handshake_response':
        break;
      case 'color_change':
        console.log('数据更新:', event.data.color);
        break;
      default:
        console.log('未知消息类型:', data);
    }
  });
</script>
